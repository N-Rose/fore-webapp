<%= Gon::Base.render_data %>
<%#= csrf_meta_tags %>

<!-- Linkers -->

<link href="//vjs.zencdn.net/5.19/video-js.min.css" rel="stylesheet">

<script src="//vjs.zencdn.net/5.19/video.min.js"></script>
<script src="http://rawgit.com/atlance01/vrapp-ionic/master/www/js/lib/videojs-playlist.js"></script>



<!-- Body -->

 
    <div class = "main-container"> 
      <div class= "player-container">
        <div class="vplayer">
          
          <div class="hole-bar-container">
            <div class="hole-bar">
              <ul >
                <li ><span>HOLE</span> <text id="hole" style>0</text></li>
                <li ><span>PAR</span> <text id="par">0</text></li>
                <li ><span>YD</span> <text id="yard">0</text></li>
                <li id="lastli" ><span>HDCP</span> <text id="mhcp">0</text></li>
              </ul>
            </div>
          </div>
          
          <video id="hole-vid" class="video-js vjs-default-skin vjs-big-play-centered"></video>
          
          <div class="previous on-video"><h1> < </h1></div>
          <div class="next on-video"><h1> > </h1></div>
          <div class="flag on-video"><%= image_tag "flag.png" %></div>
          <div class="eye on-video"><%= image_tag "eye.png" %></div>
          <div class="upload on-video"><%= image_tag "flag.png" %></div>
          <div class="logo on-video"><%= image_tag "logo.png" %></div>

          <div class="vjs-playlist">
            <div  class="playlist">
              <ul id="playlist" >
                
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>

<!-- <button class="flag"><i class="fa fa-flag" aria-hidden="true"></i></button>
<button class="eye"><i class="fa fa-eye" aria-hidden="true"></i></i></button>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"> 
 -->


<!-- JavaScript -->

<script type="text/javascript">
var videoList = []

for (var i = 0, len = gon.videos_urls.length; i < len; i++) {
  videoList.push({
    sources: [{
      src: gon.videos_urls[i],
      type: 'video/mp4'
    }]
  });
}


var player = videojs('hole-vid', {
  preload: true, inactivityTimeout: 0, controls: true, width: 700, height:400,
   controlBar: {
    children:[
      'playToggle',
      'progressControl',
      'volumeMenuButton',
      'playbackRateMenuButton',
      'fullscreenToggle'
    ],
    playbackRateMenuButton: { playbackRates: [0.5, 1, 1.5, 2] },
    inactivityTimeout: 0
    // muteToggle: true
    }
});

try {player.volume(1);} catch (e) {}

player.playlist(videoList);

document.querySelector('.previous').addEventListener('click', function() {
  player.playlist.previous();
});
document.querySelector('.next').addEventListener('click', function() {
  player.playlist.next();
});

document.querySelector('.flag').addEventListener('click', function() {
  for (var i = 0, len = gon.videos.length; i < len; i++) {
    if (gon.tags[i].length > 0) {
      if (player.currentSrc().includes(gon.videos[i].video_file_name) && gon.videos[i].id == gon.tags[i][0].video_id) {
        player.currentTime(gon.tags[i][0].time);
      }
    }
  }
});

player.on("loadedmetadata",function () {
  barupdate();
  current_video();
});
window.onload=playlisyui();


/* ADD PREVIOUS */
// var Button = videojs.getComponent('Button');

// var PrevButton = videojs.extend(Button, {
//   constructor: function() {
//     Button.apply(this, arguments);
//     this.addClass('icon-angle-left');
//     this.controlText("Previous");
//   },

//   handleClick: function() {
//     player.playlist.previous();
//   }
// });

//   handleClick: function() {
//     for (var i = 0, len = gon.videos.length; i < len; i++) {
//       if (gon.tags[i].length > 0) {
//         if (player.currentSrc().includes(gon.videos[i].video_file_name) && gon.videos[i].id == gon.tags[i][0].video_id) {
//           player.currentTime(gon.tags[i][0].time);
//         }
//       }
//     }
//   }
// });

// Register the new component
// videojs.registerComponent('PrevButton', PrevButton);
// player.getChild('controlBar').addChild('PrevButton', {}, 0);

function playlisyui(){
  // for (var i = 0, len = gon.videos_urls.length; i < len; i++) {
    for (var i = 1, len = 19; i < len; i++) {
      document.getElementById('playlist').innerHTML += '<li id="'+i+'" onClick="select_video(this.id)">'+i+'</li>';
    }
}

function barupdate(){
  
  document.getElementById('hole').innerHTML = leftPad(player.playlist.currentItem()+1,2);
  document.getElementById('par').innerHTML = leftPad(gon.par[player.playlist.currentItem()],1);
  document.getElementById('yard').innerHTML = leftPad(gon.yard[player.playlist.currentItem()],3);
  document.getElementById('mhcp').innerHTML = leftPad(gon.mhcp[player.playlist.currentItem()],2);

}

function leftPad(number, targetLength) {
    var output = number + '';
    while (output.length < targetLength) {
        output = '0' + output;
    }
    return output;
}

function select_video(id){
  id-=1;
  if (player.playlist.currentItem()!= hole){
    player.playlist.currentItem(id);
    current_video();
  }
}

function current_video(){
  id = player.playlist.currentItem();
  for (i=0;i<18;i++){
    if (i===id){
      document.getElementById(i+1).className = "active";
      console.log('im in id');
    }
    else{
      document.getElementById(i+1).removeAttribute("class");
            console.log(i);
    }
  }
}


</script>

<!-- StyleSheet -->

<style type="text/css">
.player-container{
  position: absolute;
}
.vplayer{
  z-index: -1;
}
.video-js .vjs-big-play-button {
  width: 50px;
  height: 50px;
  font-size: 40px;
  line-height: 46px;
  border: 2px solid;
  border-radius: 50%;
  background: transparent !important;
}
.vjs-big-play-centered .vjs-big-play-button {
  top: 45%;
  left:55%;
}
.hole-bar-container {
  width: 50%;
  left:22%;
  height: 29px;
  position: absolute;
  margin-top: 4px;
  z-index: 5;
  text-align: center;
  background-color: rgba(240,248,255,0.3);
  border-radius: 5px;
}
.hole-bar{
  /*left:22%;*/
  /*margin-top: 4px;*/
  margin-top: 2px;
  margin-left: 2.5%;
  width: 95%;
  height: 25px;
  /*position: absolute;*/
  border-radius: 5px;
  opacity: 1;
  background: linear-gradient(#696969, black);

  /*z-index: 5;*/
  /*background: -webkit-linear-gradient(#313133,#242426,#313133);*/ /* For Safari 5.1 to 6.0 */
  /*background: -o-linear-gradient(#313133,#242426,#313133);*/ /* For Opera 11.1 to 12.0 */
  /*background: -moz-linear-gradient(#313133,#242426,#313133);*/ /* For Firefox 3.6 to 15 */
  /*background: linear-gradient(#313133,#242426,#313133);*/ /* Standard syntax (must be last) */

}
.hole-bar ul{
  list-style: none; 
  width:100%;
  margin: 0;
  padding: 3px;
  text-align: center;
}
.hole-bar ul li {
  color:white; 
  width:24%; 
  float:left;
  border-right: 2px solid #696969;
}
#lastli {
  border: 0;
}
.hole-bar ul li span {
  font-size:14px;
}
.hole-bar ul li text {
  font-size:18px; 
  font-family: sans-serif;
}
.on-video {  
    z-index: 5;
    background-color: transparent;
    cursor: pointer;
    opacity: 1;
    filter: alpha(opacity=100); /* For IE8 and earlier */
    color: white;
}

  .previous{
    /*margin:top right down left;*/
    position: absolute;
    left: 10px;
    top: 45%;
    height: 100px; 
    font-family: "Times New Roman", Times, serif;
   }
  .next{
    position: absolute;
    right: 10px;
    top: 45%;
    height: 100px; 
    font-family: "Times New Roman", Times, serif;
  }

  .flag {
    display:block;
    position: absolute;
    right: 2%;
    top: 7px;
    height: 30px;
    width: 30px;
  }

  .eye {
    display:block;
    position: absolute;
    right: 10%;
    top: 7px;
    height: 30px;
    width: 30px;
  }
  .upload {
    display:block;
    position: absolute;
    right: 18%;
    top: 7px;
    height: 30px;
    width: 30px;
  }

  .logo {
    display:block;
    position: absolute;
    width: 13%;
    height: 18px;
    left: 1%;
    top: 7px;
     
  }

img {
    min-width: 20%;
    min-height: 20%;
    max-width: 90%;
    max-height: 90%;
}

/*img:hover {
  transform: scale( 1.05 );
}
*/

.vjs-playlist {
  left:0px ;
  width:100%; 
  height:35px;
}
.playlist{
  height: 30px;
  background: linear-gradient(#696969, black);
}

.playlist ul{
  list-style: none; 
  width:100%;
  margin: 0 0 0 0;
  padding: 5px 0 0 0;
}
.playlist ul li {
  padding: 0;
  color:#C0C0C0; 
  width:5.4%;
  text-align: center; 
  float:left;
  vertical-align: center;
  cursor: pointer;
}
.playlist ul li.active {
  color:white; 
}

 

</style>
