<div id="course-page-content-wrapper" class="col-md-12" style="margin-top: 0px;">
  <%= form_for(@course, url: url_for(controller: 'courses', action: 'update'), method: :put, :html => { :multipart => true }) do |f| %>
    <div class="col-md-12 course-info-row">
      <div class="col-md-12">
        <h4>Course Information</h4>
      </div>
      <div class="col-md-4 form-group">
        <%= label_tag :name ,'Name',class: "col-md-12 zero-left-right-padd"%>
        <%= f.text_field :name , class: "col-md-12 form-control check-field", placeholder: "Full name of course"%>
      </div>

      <div class="col-md-4 cover-first-row-photos bucket">
        <%= label_tag :cover ,'Cover Photo',class:"col-md-12 zero-left-right-padd "%>
        <div class="cover-label">
          <%= f.file_field :cover, class: 'btn btn-success upload-btn check-field cover-field' %>
        </div>
        <div class="cover image-division">
          <% if @course.cover.present? %>
            <img src="<%= @course.cover.url %>" class="course-logo-image cimage" id="<%=params[:id]%>" name="cover">
          <% end %>
        </div> 
      </div>

      <div class="col-md-4 second-row-photos">
        <%= label_tag :photos ,'Photos',class:"col-md-12 zero-left-right-padd "%>
        <div class="clearfix"></div>
        <div class="btn btn-success upload-btn">
          <%= file_field_tag "images[]", type: :file, multiple: true, class: 'course-photos-field' %>
          <%# course_photo_url = @course.course_images %>
          <div class="temp-photos-collection"></div>
          <div class="photos-collection">
            <% @course.course_images.each do |course_photo|%>
              <div class="photo-division">
                <span class="close-photos" data-photo-id="<%= course_photo.id %>">&times;</span>
                <img src="<%= course_photo.photo.url %>" class="course-photo-images" id="<%= course_photo.id %>">
              </div>
            <% end %>
          </div>
        </div>
      </div>
    </div>
    <div class="col-md-12 course-info-row">
      <div class="col-md-4 form-group">
        <%= label_tag :bio ,'Bio',class: "col-md-12 zero-left-right-padd"%>
        <%= f.text_area :bio, rows: "4", class: 'col-md-12 form-control check-field'%>
      </div>
      <div class="col-md-4 form-group">
        <%= label_tag :color_selector ,'Color Selector',class:"col-md-12 zero-left-right-padd"%>
        <%= f.text_field :color_selector, class: "col-md-12 form-control check-field", placeholder: "Color Selector" %>
      </div>
    </div>
    <div class="col-md-12 course-info-row">
      <h4 class="col-md-4 playlist_heading">Playlist</h4>
      <% @course.videos.each_with_index do |video, index| %>
        <% if video.id.present? %>
          <div class="col-md-12 course-info-row video_item" id="video_item_<%= index %>">
            <div class="col-md-4 form-group">
              <%= label_tag :title ,"Item ##{index + 1}",class:"col-md-12 zero-left-right-padd"%>
              <%= text_field_tag "course_video[#{video.id}][title]", video.title, class: "col-md-12 form-control check-field", placeholder: "Item Title"%>
            </div>
            <div class="col-md-4">
              <%= label_tag :video ,'Video',class: "col-md-12 zero-left-right-padd "%>
              <div class="clearfix"></div>
              <div class="btn btn-success upload-btn">
                <div class="cover-label">
                  <%= file_field_tag "course_video[#{video.id}][video]", class: 'check-field cover-field' %>
                  <div class="video-collection"><%= video.video_file_name %></div>
                </div>
              </div>
            </div>
            <div class="col-md-4">
              <%= label_tag :thumbnail_image ,'Thumbnail Image', class: "col-md-12 zero-left-right-padd"%>
              <div class="clearfix"></div>
              <div class="btn btn-success upload-btn">
                <%= file_field_tag "course_video[#{video.id}][thumbnail_image]", type: :file %>
                <%# course_photo_url = @course.course_images %>
                <div class="photos-collection">
                  <div class="photo-division">
                    <img src="<%= video.thumbnail_image.url %>" class="course-photo-images" id="<%= video.id %>">
                  </div>
                </div>
              </div>
            </div>

            <div class="col-md-4">
              <%= label_tag :bio ,'Description',class:"zero-left-right-padd"%>
              <%= text_area_tag "course_video[#{video.id}][description]", video.description, rows: "4", class: 'form-control check-field'%>
            </div>
            <div class="col-md-4">
              <%= link_to "Remove Video", admin_video_path(video), class: "btn btn-danger", method: :delete, data: { confirm: 'Are you sure?' }, style: "    margin-top: 45px;"%>
            </div>
          </div>
        <% end %>
      <% end %>
      <%#= render 'videos_form', video_index: @course.videos.count + 1 %>
      <div class="col-md-12">
        <button type="button" class="btn btn-info btn-add" id='add_playlist' href="javascript:void(0)">+</button>
        <button type="button" class="btn btn-info btn-add" id='remove_playlist' href="javascript:void(0)" style="display: none;">-</button>
      </div>
    </div>
    <h4 class="col-md-4">Scorecard</h4>
    <% @course.score_cards.each do |scorecard| %>

      <div class="col-md-12 course-info-row scorecard zero-left-right-padd" id="scorecard">
        <div class="col-md-2 ">
          <%= text_field_tag "course_scorecard[#{scorecard.id}][tee_name]", scorecard.tee_name, class: "col-md-12 form-control", placeholder: "Tee Name"%>
        </div>
        <div class="col-md-3">
          <%= select_tag "course_scorecard[#{scorecard.id}][color]", options_for_select(["Green", "Red", "White", "Blue", "Violet", "Gold", "Teal", "LightBlue", "Black"], scorecard.color), class:'dropdown-less-padd form-control inline check-field' ,style: 'margin-left:10px;'%>
        </div>
        <div class="col-md-6">
          <div class="col-md-3">
            <%= text_field_tag "course_scorecard[#{scorecard.id}][total_par]", scorecard.total_par, class: "col-md-12 form-control total_par", placeholder: "PAR", readonly: true%>
          </div>
          <div class="col-md-3">
            <%= text_field_tag "course_scorecard[#{scorecard.id}][total_yards]", scorecard.total_yards, class: "col-md-12 form-control total_yards", placeholder: "YARDS", readonly: true%>
          </div>
          <div class="col-md-3">
            <%= text_field_tag "course_scorecard[#{scorecard.id}][total_rating]", scorecard.rating.to_i, class: "col-md-12 form-control total_rating", placeholder: "RATING"%>
          </div>
          <div class="col-md-3">
            <%= text_field_tag "course_scorecard[#{scorecard.id}][total_slope]", scorecard.slope.to_i, class: "col-md-12 form-control total_slope", placeholder: "SLOPE"%>
          </div>
        </div>
        <div class="col-md-1">
          <%= link_to "-", admin_score_card_path(scorecard), class: "btn btn-info btn-add", method: :delete, data: { confirm: 'Are you sure?' }%>
        </div>
        <div class="col-md-12 zero-left-right-padd">
          <table class="table borderless scorecard_table">
            <thead>
              <th>TEE</th>
              <% (1..9).each do |int|%>
                <th><%= int %></th>
              <% end %>
              <th>OUT</th>
              <% (10..18).each do |int|%>
                <th><%= int %></th>
              <% end %>
              <th>IN</th>
              <th>TOT</th>
            </thead>
            <tbody>
              <tr>
                <td><strong>YDS</strong></td>
                <% yards_data = scorecard.get_yards_data %>
                <% (1..9).each do |int|%>
                  <td>
                    <%= text_field_tag "course_scorecard[#{scorecard.id}][holes][#{int}][yardges]", yards_data[int-1], class: "form-control yards_input yards_input_first_half"%>
                  </td>
                <% end %>
                <td>
                  <%= text_field_tag "course_scorecard[#{scorecard.id}][yds_out]", yards_data[9], class: "form-control yards_first_total", readonly: true%>
                </td>
                <% (10..18).each do |int|%>
                  <td>
                    <%= text_field_tag "course_scorecard[#{scorecard.id}][holes][#{int}][yardges]", yards_data[int], class: "form-control yards_input yards_input_second_half"%>
                  </td>
                <% end %>
                <td>
                  <%= text_field_tag "course_scorecard[#{scorecard.id}][yds_in]", yards_data[19], class: "form-control yards_second_total", readonly: true%>
                </td>
                <td>
                  <%= text_field_tag "course_scorecard[#{scorecard.id}][yds_final_out]", yards_data[20], class: "form-control yards_total", readonly: true%>
                </td>
              </tr>

              <tr>
                <td><strong>PAR</strong></td>
                <% par_data = scorecard.get_pars_data %>
                <% (1..9).each do |int|%>
                  <td>
                    <%= text_field_tag "course_scorecard[#{scorecard.id}][holes][#{int}][par]", par_data[int-1], class: "form-control par_input_first_half par_input"%>
                  </td>
                <% end %>
                <td>
                  <%= text_field_tag "course_scorecard[#{scorecard.id}][par_out]", par_data[9], class: "form-control par_first_total", readonly: true%>
                </td>
                <% (10..18).each do |int|%>
                  <td>
                    <%= text_field_tag "course_scorecard[#{scorecard.id}][holes][#{int}][par]", par_data[int], class: "form-control par_input_second_half par_input"%>
                  </td>
                <% end %>
                <td>
                  <%= text_field_tag "course_scorecard[#{scorecard.id}][par_in]", par_data[19], class: "form-control par_second_total", readonly: true%>
                </td>
                <td>
                  <%= text_field_tag "course_scorecard[#{scorecard.id}][par_final_out]", par_data[20], class: "form-control par_total", readonly: true%>
                </td>
              </tr>
              <tr>
                <td><strong>HCP</strong></td>
                <% hcp_data = scorecard.get_hcps_data%>
                <% (1..9).each do |int|%>
                  <td>
                    <%= text_field_tag "course_scorecard[#{scorecard.id}][holes][#{int}][hcp]", hcp_data[int-1], class: "form-control"%>
                  </td>
                <% end %>
                <td>
                  
                </td>
                <% (10..18).each do |int|%>
                  <td>
                    <%= text_field_tag "course_scorecard[#{scorecard.id}][holes][#{int}][hcp]", hcp_data[int], class: "form-control"%>
                  </td>
                <% end %>
                <td>
                  
                </td>
                <td>
                  
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    <% end %>
    <%#= render 'scorecard_form', scorecard_index: @course.score_cards.count + 1 %>
    <div class="col-md-12">
      <button type="button" class="btn btn-info btn-add" id='add_scorecard' href="javascript:void(0)">+</button>
      <button type="button" class="btn btn-info btn-add" id='remove_scorecard' href="javascript:void(0)" style="display: none;">-</button>
    </div>
    <div class="col-md-12 actions mar-top-50">
      <%= f.submit "Next", class: 'btn btn-primary' %>
      <%= link_to 'Back', admin_resort_courses_path(@course.resort) %>
    </div>
  <%end%>

  <%#= render :partial => 'admin/resorts/new_modal' %>
  <%#= render :partial => 'admin/networks/new_modal' %>
</div>



<script type="text/javascript">
  var video_index = <%= @course.videos.count %>;
  var scorecard_index = <%= @course.score_cards.count %>;
  $("#add_playlist").on('click', function(){
    $.ajax({
      url: "<%= admin_add_playlist_item_path %>",
      type: "GET",
      data: {video_index: video_index}
    });
    video_index ++;
  })

  $("#remove_playlist").on('click', function(){
    video_index --;
    var last_video_element = $(".video_item").last();
    $(last_video_element).remove();
    if ($(".video_item").length == 1){
      $("#remove_playlist").hide();
    }
  })

  $("#add_scorecard").on('click', function(){
    $.ajax({
      url: "<%= admin_add_scorecard_path %>",
      type: "GET",
      data: {scorecard_index: scorecard_index}
    });
    scorecard_index ++;
  })

  $("#remove_scorecard").on('click', function(){
    scorecard_index --;
    var last_scorecard = $(".scorecard").last();
    $(last_scorecard).remove();
    if ($(".scorecard").length == 1){
      $("#remove_scorecard").hide();
    }
  });
</script>
